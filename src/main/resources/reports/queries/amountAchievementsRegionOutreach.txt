select INITCAP(R.REGION_NAME) REGION_NAME_AMT,
SUM(NVL(TA.ACH,0)) ACHIEVMENT_NO,
SUM(NVL(TA.ACH_AMT,0)) ACHIEVMENT_AMT
from target_achievements@LINK_TO_TESTMWC ta, branch@LINK_TO_TESTMWC b, location@LINK_TO_TESTMWC l, region@LINK_TO_TESTMWC r
where ta.BRANCH_CD = b.BRANCH_CD
and b.LOCATION_ID = l.LOCATION_ID
and l.REGION_CD = r.REGION_CD
and ta.PRODUCT_CODE not in (8,19)
and TO_cHAR(ta.PAR_DATE,'YYYY') =TO_cHAR(TO_DATE(:asOfDate, 'dd-MM-yyyy'),'YYYY')
and TO_cHAR(ta.PAR_DATE,'MM') = TO_cHAR(TO_DATE(:asOfDate, 'dd-MM-yyyy'),'MM')
GROUP BY INITCAP(R.REGION_NAME)
ORDER BY INITCAP(R.REGION_NAME)
